<!DOCTYPE html>
<html>
<head>
    <title>AI CMS Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h1>üß† –ü–†–û–ï–ö–¢ –ù–ê –ë–ê–ë–ö–ò ‚Äî –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
    <div class="card">
        <h2>–°–∞–π—Ç—ã</h2>
        <table>
            <thead>
                <tr><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>AdSense</th><th>–ü–∞—Ä—Ç–Ω—ë—Ä–∫–∏</th><th>–ü—Ä–æ–¥–∞–∂–∏</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr>
            </thead>
            <tbody id="siteTable"></tbody>
        </table>
    </div>
    <div class="card">
        <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–∞–π—Ç</h2>
        <form onsubmit="createSite(event)">
            <input type="text" id="niche" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏—à—É..." required>
            <button type="submit">–°–æ–∑–¥–∞—Ç—å</button>
        </form>
    </div>
    <script>
        async function loadDashboard() {
            const res = await fetch('/api/sites');
            const data = await res.json();
            const tbody = document.getElementById('siteTable');
            tbody.innerHTML = '';
            for (const [site, stats] of Object.entries(data)) {
                tbody.innerHTML += `<tr>
                    <td>${site}</td>
                    <td>$${stats.adsense}</td>
                    <td>$${stats.affiliate}</td>
                    <td>$${stats.sales}</td>
                    <td>
                        <a href="/edit/${site}/page-1.html" target="_blank">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                    </td>
                </tr>`;
            }
        }
        async function createSite(e) {
            e.preventDefault();
            const niche = document.getElementById('niche').value;
            await fetch('/api/create', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ niche })
            });
            alert('–°–∞–π—Ç —Å–æ–∑–¥–∞–Ω!');
            location.reload();
        }
        loadDashboard();
    </script>
</body>
</html>